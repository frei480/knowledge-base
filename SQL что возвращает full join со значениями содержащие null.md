---
tags:
  - SQL
---
При использовании **`FULL JOIN`** (или **`FULL OUTER JOIN`**) в SQL результат будет включать **все строки из обеих таблиц**, даже если для них нет совпадений в связанной таблице. Если совпадения нет, то в колонках из отсутствующей таблицы будут подставлены значения **`NULL`**. 

### Что возвращает `FULL JOIN` с `NULL`-значениями?
1. **Строки с совпадениями** (матчинг по условию `ON`):
   - Возвращаются объединенные данные из обеих таблиц.

2. **Строки без совпадений**:
   - Если строка есть в левой таблице (`LEFT`), но нет в правой (`RIGHT`), то колонки правой таблицы заполняются `NULL`.
   - Если строка есть в правой таблице (`RIGHT`), но нет в левой (`LEFT`), то колонки левой таблицы заполняются `NULL`.

---

### Пример
Допустим, есть две таблицы:

**Таблица A (Employees)**:
| id | name  |
|----|-------|
| 1  | Alice |
| 2  | Bob   |
| 3  | NULL  |  <- `NULL` в колонке `name`

**Таблица B (Departments)**:
| id | department |
|----|------------|
| 1  | HR         |
| 4  | IT         |
| 5  | NULL       |  <- `NULL` в колонке `department`

Выполним запрос:
```sql
SELECT A.name, B.department
FROM Employees A
FULL JOIN Departments B 
ON A.id = B.id;
```

**Результат**:
| name  | department |
|-------|------------|
| Alice | HR         |  <- совпадение по `id=1`
| Bob   | NULL       |  <- есть в `A`, но нет в `B` (`id=2`)
| NULL  | IT         |  <- есть в `B`, но нет в `A` (`id=4`)
| NULL  | NULL       |  <- `id=3` из `A` и `id=5` из `B` (не совпадают)

---

### Особенности `NULL` в `FULL JOIN`:
1. **`NULL` в исходных данных**:
   - Если в колонках исходных таблиц есть `NULL`, они **не считаются совпадением** (`NULL != NULL` в SQL).
   - Например, строка с `name = NULL` в таблице `A` не совпадет со строкой `department = NULL` в таблице `B`.

2. **`NULL` как результат отсутствия совпадений**:
   - Если для строки из `A` нет совпадения в `B`, колонки из `B` заполняются `NULL` (и наоборот).

---

### Визуализация логики `FULL JOIN`:
```
ЛЕВАЯ ТАБЛИЦА (A)          ПРАВАЯ ТАБЛИЦА (B)
    |                          |
    |-- Совпадения --|         |
    |                |         |
    |-- Только в A --|         |
    |                          |-- Только в B --|
```

---

### Когда использовать `FULL JOIN`?
- Когда нужно получить **полный набор данных из обеих таблиц**, включая отсутствующие связи.
- Например, анализ данных, где важно видеть "пропущенные" значения в обоих направлениях.

Если нужно игнорировать `NULL`, используйте условия `WHERE` или `COALESCE()`, чтобы заменить `NULL` на другое значение. Например:
```sql
SELECT COALESCE(A.name, 'N/A') AS name, 
       COALESCE(B.department, 'No Dept') AS department
FROM Employees A
FULL JOIN Departments B ON A.id = B.id;
```