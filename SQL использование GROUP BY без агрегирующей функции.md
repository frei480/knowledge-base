---
tags:
  - SQL
---

При использовании `GROUP BY` без агрегатных функций результат зависит от конкретной СУБД (системы управления базами данных) и её настроек:

### 1. **Стандарт SQL**
   - Согласно стандарту, все столбцы в `SELECT`, не участвующие в агрегатных функциях (например, `SUM`, `COUNT`, `AVG`), **должны быть указаны в `GROUP BY`**.  
   - Если это правило нарушено, запрос считается некорректным, и большинство СУБД (например, **PostgreSQL**, **Oracle**, **SQL Server**) выдадут **ошибку**:
     ```
     ERROR: column "column_name" must appear in the GROUP BY clause or be used in an aggregate function.
     ```

---

### 2. **Особенности некоторых СУБД**
   - **MySQL** и **SQLite** (в некоторых версиях) допускают такой синтаксис.  
   - В этом случае для столбцов, не указанных в `GROUP BY` и не агрегированных, возвращается **первое попавшееся значение** из группы.  
   - Пример:
     ```sql
     -- MySQL/SQLite: вернет первое значение `name` для каждой группы `category`
     SELECT category, name FROM products GROUP BY category;
     ```
     Результат может быть неочевидным, так как выбор значения `name` происходит случайно (зависит от порядка данных в таблице).

---

### 3. **Почему это плохо?**
   - **Непредсказуемость**: Значения неагрегированных столбцов могут быть любыми из группы, что часто приводит к ошибкам в логике запроса.
   - **Несоответствие стандарту**: Код становится непереносимым между разными СУБД.
   - **Семантическая ошибка**: `GROUP BY` предназначен для агрегации данных, а не для выбора произвольных строк.

---

### Примеры
#### Некорректный запрос (ошибка в PostgreSQL):
```sql
SELECT department, employee_name FROM employees GROUP BY department;
-- Ошибка: столбец "employee_name" должен быть в GROUP BY или внутри агрегатной функции.
```

#### Корректный запрос:
```sql
-- Использование агрегатной функции (например, MAX)
SELECT department, MAX(employee_name) 
FROM employees 
GROUP BY department;
```

---

### Вывод
Всегда указывайте агрегатные функции для столбцов, не входящих в `GROUP BY`, либо включайте эти столбцы в группировку. Иначе поведение запроса зависит от СУБД и может привести к ошибкам или неожиданным результатам.