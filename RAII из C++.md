---
tags:
  - cplusplus
---

**RAII (Resource Acquisition Is Initialization)** ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∏–¥–∏–æ–º–∞ C++, —É–ø—Ä–∞–≤–ª—è—é—â–∞—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Ä–µ—Å—É—Ä—Å–æ–≤ (–ø–∞–º—è—Ç—å, —Ñ–∞–π–ª—ã, –º—å—é—Ç–µ–∫—Å—ã) —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –ï–≥–æ —Å—É—Ç—å: **–ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –æ–±—ä–µ–∫—Ç–∞, –∞ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ ‚Äî –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ**. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ä–µ—Å—É—Ä—Å –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –æ–±—ä–µ–∫—Ç–∞ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏, –¥–∞–∂–µ –≤ —Å–ª—É—á–∞–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.

# üîë –ö–ª—é—á–µ–≤—ã–µ –ü—Ä–∏–Ω—Ü–∏–ø—ã RAII:
1. **–†–µ—Å—É—Ä—Å –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ** –æ–±—ä–µ–∫—Ç–∞.
2. **–†–µ—Å—É—Ä—Å –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ** (–∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞).
3. **–û–±—ä–µ–∫—Ç –≤–ª–∞–¥–µ–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–º** ‚Äî –µ–≥–æ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ = –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ä–µ—Å—É—Ä—Å–∞.

# ‚öôÔ∏è –ö–∞–∫ –≠—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç (–Ω–∞ –ü—Ä–∏–º–µ—Ä–µ —Ñ–∞–π–ª–∞):
```cpp
#include <fstream>

void readFile() {
    // –†–µ—Å—É—Ä—Å (—Ñ–∞–π–ª) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –æ–±—ä–µ–∫—Ç–∞ `file`
    std::ifstream file("data.txt");
    
    if (!file.is_open()) {
        throw std::runtime_error("File not found!");
    }
    
    // –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...
    // –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä `file` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä–æ–µ—Ç —Ñ–∞–π–ª –∑–¥–µ—Å—å (–ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏)
}
```
–î–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä `file` –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω, –∏ —Ñ–∞–π–ª –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º.

# üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –° –†—É—á–Ω—ã–º –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º (–±–µ–∑ RAII):
```cpp
// –ü–õ–û–•–û: —Ä–∏—Å–∫ —É—Ç–µ—á–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
void unsafeExample() {
    FILE* file = fopen("data.txt", "r");
    if (!file) { /* –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ */ }
    
    // –ï—Å–ª–∏ –∑–¥–µ—Å—å –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ -> —Ñ–∞–π–ª –Ω–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è!
    // ...
    fclose(file); // –Ω—É–∂–Ω–æ –Ω–µ –∑–∞–±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç—å –≤—Ä—É—á–Ω—É—é
}
```

# üí° –ü–æ—á–µ–º—É RAII –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –í–∞–∂–µ–Ω –í C++?
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–π**
   –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –≤—ã–∑—ã–≤–∞—é—Ç—Å—è **–¥–∞–∂–µ –ø—Ä–∏ –≤—ã–±—Ä–æ—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è**, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏.
2. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞–º–∏**
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –æ —Ä—É—á–Ω–æ–º –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏.
3. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ "–≤–∏—Å—è—á–∏—Ö —É–∫–∞–∑–∞—Ç–µ–ª–µ–π"**
   –†–µ—Å—É—Ä—Å –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ (–≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ).
4. **–ß–∏—Å—Ç—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥**
   –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å —Ä–µ—Å—É—Ä—Å–æ–º –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ.

# üõ†Ô∏è –¢–∏–ø–∏—á–Ω—ã–µ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è RAII:
1. **–£–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏** (`std::unique_ptr`, `std::shared_ptr`)
   ```cpp
   {
       auto ptr = std::make_unique<int>(42); // –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∞
       // –ü–∞–º—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –±–ª–æ–∫–∞
   }
   ```
2. **–†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏** `std::fstream`, `std::ifstream`

3. **–ú—å—é—Ç–µ–∫—Å—ã** `std::lock_guard`, `std::unique_lock`
   ```cpp
   std::mutex mtx;
   {
       std::lock_guard<std::mutex> lock(mtx); // –º—å—é—Ç–µ–∫—Å –∑–∞—Ö–≤–∞—á–µ–Ω
       // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è...
       // –ú—å—é—Ç–µ–∫—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –±–ª–æ–∫–∞
   }
   ```
4. **–°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** (–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö –≤—Ä–æ–¥–µ Boost.Asio).
5. **–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã** (OpenGL/Vulkan –æ–±—ä–µ–∫—Ç—ã).

# üß© –ö–æ–Ω—Ç—Ä–æ–ª—å –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ò –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:
–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã RAII-–∫–ª–∞—Å—Å–æ–≤ –≤–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:
- **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è/–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è** (–µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å –º–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å/–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å).
- **–û–ø–µ—Ä–∞—Ç–æ—Ä –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è**.
- **–î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä** (–æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å).

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–µ—Ç–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:
```cpp
class FileRAII {
    FILE* file;
public:
    explicit FileRAII(const char* name) : file(fopen(name, "r")) {}
    ~FileRAII() { if (file) fclose(file); }
    
    // –ó–∞–ø—Ä–µ—â–∞–µ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
    FileRAII(const FileRAII&) = delete;
    FileRAII& operator=(const FileRAII&) = delete;
    
    // –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ
    FileRAII(FileRAII&& other) noexcept : file(other.file) {
        other.file = nullptr;
    }
};
```

# üÜö RAII vs. –î—Ä—É–≥–∏–µ –Ø–∑—ã–∫–∏:
- **Java/C#**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç `try-finally` –∏–ª–∏ `using` (IDisposable), –Ω–æ —ç—Ç–æ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–æ, —á–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞.
- **Rust**: –ò–º–µ–µ—Ç —Å–∏—Å—Ç–µ–º—É –≤–ª–∞–¥–µ–Ω–∏—è (ownership), –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç RAII –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–∑—ã–∫–∞ + –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.
- **Python**: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã (`with`), –Ω–æ –æ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è.

# üíé –í—ã–≤–æ–¥:
RAII ‚Äî –æ–¥–∏–Ω –∏–∑ —Å—Ç–æ–ª–±–æ–≤ –∏–¥–∏–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ C++. –û–Ω –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç **—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏** –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–≤—ã—à–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞. –ò–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–º –ø–∞—Ç—Ç–µ—Ä–Ω–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã —É–º–Ω—ã–µ —É–∫–∞–∑–∞—Ç–µ–ª–∏, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã STL –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö C++ –±–∏–±–ª–∏–æ—Ç–µ–∫. –ü–æ–Ω–∏–º–∞–Ω–∏–µ RAII ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ C++-–∫–æ–¥–∞.