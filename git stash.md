---
tags:
  - git
---

`git stash` — это команда Git, которая временно сохраняет незавершённые изменения в вашей рабочей копии, позволяя вам переключиться на другую задачу без необходимости коммитить незаконченную работу. Вот основные моменты, которые нужно знать:

### Для чего используется?
- **Смена контекста**: Например, вы работаете в ветке `feature`, но нужно срочно переключиться на `main`, чтобы исправить баг. Изменения ещё не готовы для коммита, и вы не хотите их терять.
- **Сохранение "грязного" состояния**: Временное удаление изменений из рабочей директории (как "в ящик стола"), чтобы вернуться к чистому состоянию.

---

### Основные команды
1. **Сохранить изменения**  
   ```bash
   git stash
   ```
   Или с сообщением (удобно для поиска в списке):
   ```bash
   git stash save "Сообщение"
   ```
   - Сохраняет только отслеживаемые файлы (уже добавленные в Git).

   Чтобы включить неотслеживаемые файлы (новые, не добавленные в Git):
   ```bash
   git stash -u  # или --include-untracked
   ```

   Чтобы включить даже игнорируемые файлы (из `.gitignore`):
   ```bash
   git stash -a  # или --all
   ```

2. **Просмотреть список сохранённых stash'ей**  
   ```bash
   git stash list
   ```
   Вывод:
   ```
   stash@{0}: On main: Сообщение
   stash@{1}: On feature: Другое сообщение
   ```

3. **Вернуть изменения**  
   - **Применить последний stash и удалить его из списка**:
     ```bash
     git stash pop
     ```
   - **Применить конкретный stash (например, `stash@{1}`)**:
     ```bash
     git stash pop stash@{1}
     ```
   - **Применить stash, но не удалять его из списка**:
     ```bash
     git stash apply stash@{1}
     ```

4. **Удалить stash**  
   - Удалить последний:
     ```bash
     git stash drop
     ```
   - Удалить конкретный:
     ```bash
     git stash drop stash@{1}
     ```
   - Очистить весь список:
     ```bash
     git stash clear
     ```

5. **Создать ветку из stash**  
   Полезно, если при применении stash возникают конфликты:
   ```bash
   git stash branch new-branch-name stash@{1}
   ```

---

### Примеры использования
1. **Стандартный сценарий**:
   ```bash
   # Вносите изменения в файлы...
   git stash        # сохраняете
   git checkout main
   # Работаете в main...
   git checkout feature
   git stash pop    # возвращаете изменения
   ```

2. **Stash с неотслеживаемыми файлами**:
   ```bash
   touch new_file.txt
   git stash -u
   ```

3. **Просмотр содержимого stash**:
   ```bash
   git stash show stash@{1}  # показывает изменения
   git stash show -p stash@{1}  # показывает полный diff
   ```

---

### Важные нюансы
- **Stash работает как стек**: Последний сохранённый stash всегда имеет индекс `stash@{0}`.
- **Конфликты**: При применении stash (особенно в другой ветке) могут возникнуть конфликты. Их нужно разрешить вручную.
- **Сообщения**: Всегда добавляйте описательные сообщения к stash, чтобы позже понять, что в нём хранится.
- **Очистка**: Не забывайте удалять старые stash’и, чтобы не захламлять список.

---

`git stash` — это удобный инструмент для временного сохранения работы, который помогает эффективно переключаться между задачами, не создавая лишних коммитов.