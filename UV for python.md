---
tags:
  - python
---
пересказ видео https://www.youtube.com/watch?v=qh98qOND6MI
UV for Python… (Almost) All Batteries Included

# Введение В UV

- UV объединяет множество функций в одном инструменте и работает быстро.
- Он заменяет множество инструментов, таких как pip, pipx, poetry, pyenv и virtualenv.
- UV разработан на Rust и принадлежит компании Astral.

# Установка UV

- На Mac можно установить UV с помощью Brew.
- Для других систем можно использовать curl, pip или cargo.
## Для Windows:
```
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```
## Для macOS И Linux:
```
curl -LsSf https://astral.sh/uv/install.sh | sh
```
## Установка Uv С Помощью Pip
Если вы предпочитаете классический способ установки uv через pip из PYPI:
```
pip install uv
```
## Иные Способы Установки Uv

**Cargo**:
```
cargo install --git https://github.com/astral-sh/uv uv
```
**Homebrew**:
```
brew install uv
```
## Winget:
```
winget install --id=astral-sh.uv  -e
```
## Scoop:
```
scoop install main/uv
```
- После установки UV доступен через командную строку.
# Проверка Установленной Версии Uv

```
uv --version
```

# Обновление Uv

Если uv был установлен через автономный установщик, обновить его можно следующим образом:

```shell
uv self update
```
Если uv был установлен через pip:
```
pip install --upgrade uv
```
# Создание Нового Проекта

- Команда `uv init` создает приложение Python с файлами py и toml.
- По умолчанию используется --app, но можно создать библиотеку с помощью --package.
- UV автоматически настраивает базовые файлы и зависимости.
Содержимое директории после создания проекта:
```shell
.git
.gitignore
.python-version
hello.py
pyproject.toml
README.md
```

Файл `.python-version` содержит информацию о версии Python, используемой в проекте по умолчанию. Эта версия аналогична той, которая была установлена в системе на момент создания окружения. Файл `pyproject.toml` содержит информацию об установленных зависимостях:
```toml
[project]
name = "venv"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.13"
dependencies = []
```

`dependencies` пока пуст. Он будет наполняться по ходу установки пакетов. Посмотрим на него ещё раз, но попозже.
# Запуск И Добавление Зависимостей

• Команда `uv run` запускает программу и устанавливает зависимости.
```
uv run hello.py
```
- При выполнении `uv run` команды, uv автоматически активирует виртуальное окружение, а после завершения работы скрипта деактивирует его.
 - При первом запуске команды `uv run`, внутри `venv` будет создана директория `.venv`, содержащая устанавливаемые зависимости, используемые в окружении. Помимо этого, будет создан кроссплатформенный `uv.lock` файл.
 - Добавление зависимостей, таких как pandas, выполняется с помощью uv add.
```
uv add requests
```
Если нужно установить более одного пакета:
```shell
uv add requests yt-dlp
```
Или если нужна специфичная версия:
```shell
uv add requests==2.31.0
```
 - Удаление зависимостей также просто: uv remove.

# История И Команды UV

• Изначально UV назывался Puffin и был просто менеджером пакетов.
# Управление Зависимостями

- Команды `uv add`, `uv remove` и `uv sync` синхронизируют зависимости.
- Команда `uv lock` создает файл блокировки, а `uv lock --upgrade package` обновляет пакеты до последней версии.
- Отображение дерева зависимостей `uv tree`. Чтобы узнать для каких пакетов доступны обновления, для tree доступен флаг outdated: `uv tree --outdated`

# Рабочие Пространства

- UV поддерживает рабочие пространства для монорепозиториев.
- В рабочей области проекты могут иметь общие зависимости.
- UV управляет зависимостями и синхронизирует их между проектами.
- При создании проекта флаг --no-workspace разделяет пространства и дает устанавливать зависимости раздельно
## Виртуальные Среды И Рабочие Области

- Разные проекты в рабочей области используют одну и ту же виртуальную среду.
- Для создания отдельного проекта с собственной виртуальной средой используется команда uv.
- Рабочие области полезны для проектов с общими зависимостями.

# Использование Инструментов В UV

- В UV можно запускать пакеты Python как инструменты, например, форматировщик кода. Например: `uv tool run ruff`, `uv tool run ruff check`, короткая версия `uvx ruff check`
- папка куда устанавливаются инструменты: `uv tool dir`
- создает конфигурационный файл для оболочки: `uv tool update-shell`
- UV автоматически устанавливает инструменты во временную среду.

## Установка И Обновление Инструментов

- UV позволяет устанавливать, удалять и обновлять инструменты.
	- `uv tool install ruff`, `uv tool uninsall ruff`, `uv tool upgrade ruff
- UV автоматически определяет версии Python в системе и устанавливает их при необходимости.
- UV проверяет установленные версии и системные пути для поиска совместимых версий Python.

# Установка Конкретной Версии Python

- список установленных версий python: `uv python list`
- UV позволяет установить конкретную версию Python для проекта: `uv python install 3.12.0`
- Можно использовать ограничения для установки версии Python: `uv python install '>=3.9,3.11'`.
- установка в виртуальном окружении `uv venv --python 3.13.0`
- UV упрощает управление проектами на Python и заменяет множество инструментов.

14:01 Недостатки и улучшения UV

• UV не имеет пользовательских скриптов, что было бы полезно.
• UV не имеет встроенного бэкенда сборки, что требует использования сторонних инструментов.
• В GitHub есть запрос на добавление встроенного бэкенда сборки на Rust.

15:54 Публикация пакетов на Python

• UV Publish позволяет публиковать пакеты на PyPI с помощью GitHub-действия.
• В некоторых проектах используется настройка доверенного издателя на PyPI.
• UV Build используется для создания исходного кода и дистрибутива, а UV Publish — для публикации.

16:50 Заключение и призыв к обсуждению

• Автор просит поделиться мнением о UV и его недостатках.
• В GitHub есть дополнительные ресурсы для настройки проектов с UV.
• Видео завершается благодарностью за просмотр и приглашением к следующему выпуску.

