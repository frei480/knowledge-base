---
tags:
  - АрхитектураПО
---

**Dependency Injection (DI)** — это шаблон проектирования в разработке программного обеспечения, который позволяет объектам получать свои зависимости извне, а не создавать их самостоятельно. Это делает код более гибким, модульным и удобным для тестирования.

### Как это работает?
1. **Разделение ответственности**: Объекты не создают свои зависимости (например, другие классы, сервисы, базы данных), а получают их "извне".
2. **Инверсия управления**: Управление зависимостями передается внешнему компоненту (например, DI-контейнеру или фабрике).

### Пример без DI:
```java
class UserService {
    private DatabaseConnection db = new DatabaseConnection(); // Зависимость создается внутри класса
    // ... логика работы с базой данных
}
```
Здесь `UserService` жестко зависит от конкретной реализации `DatabaseConnection`.

### Пример с DI (через конструктор):
```java
class UserService {
    private DatabaseConnection db;

    // Зависимость "внедряется" через конструктор
    public UserService(DatabaseConnection db) {
        this.db = db;
    }
    // ... логика работы с базой данных
}
```
Теперь `UserService` не знает, как создается `DatabaseConnection`, и может работать с любой его реализацией.

---

### Типы Dependency Injection:
1. **Через конструктор** (наиболее распространенный):  
   Зависимости передаются при создании объекта.
2. **Через сеттеры**:  
   Зависимости задаются через методы-сеттеры.
3. **Через интерфейсы**:  
   Класс реализует интерфейс, через который получает зависимости.

---

### Зачем это нужно?
1. **Упрощение тестирования**:  
   Можно подменять зависимости на "заглушки" (моки) в тестах.  
   Например, вместо реальной базы данных использовать имитацию.
2. **Гибкость и переиспользование кода**:  
   Легко менять реализации зависимостей без изменения основного кода.
3. **Соблюдение принципа SOLID**:  
   DI напрямую связан с **Dependency Inversion Principle** (D в SOLID):  
   _«Зависимости должны строиться на абстракциях, а не на деталях»_.

---

### DI-контейнеры
Для автоматизации внедрения зависимостей используются DI-контейнеры (например, Spring для Java, Dagger для Android, .NET Core DI). Они:
- Автоматически создают объекты.
- Определяют, какие зависимости нужны.
- Внедряют их в нужные места.

Пример настройки контейнера (псевдокод):
```java
// Регистрируем зависимости:
container.register(DatabaseConnection.class, MySqlConnection.class);
container.register(UserService.class);

// Контейнер автоматически создаст UserService, передав ему MySqlConnection.
UserService service = container.resolve(UserService.class);
```

---

### Итог
Dependency Injection — это способ сделать код менее связанным, более гибким и тестируемым, передавая управление зависимостями внешнему компоненту. Это ключевой элемент современных архитектур, таких как микросервисы или чистая архитектура.