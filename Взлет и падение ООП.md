Автор Егор Бугаенко
https://www.youtube.com/watch?v=hkK8bvvz9OI
"Взлет и падение ООП", XX Ершовская лекция, НГУ, Новосибирск

00:00 Введение

• Автор благодарит организаторов за приглашение и возможность обсудить объектно-ориентированное программирование.
• Упоминает свою книгу "Elegant objects" и фреймворк "Takes".
• Активно участвует в разработке языка программирования "EOLANG".

01:38 Структура доклада

• Доклад разделен на три части: прекрасный мир объектов, трудности объектов и попытки помочь им.
• Цель доклада - пробудить интерес к теме и привлечь новых участников к исследованиям.

02:35 Предупреждение

• Некоторые утверждения могут не понравиться программистам.
• Призывает слушателей дослушать лекцию до конца, несмотря на возможные несогласия.

03:06 История объектно-ориентированного программирования

• Три основных языка: SIMULA, Smalltalk и C++.
• SIMULA был создан для симуляции процессов, но стал первым объектно-ориентированным языком.
• Smalltalk предложил концепцию "все объект", но имел проблемы со скоростью выполнения.
• C++ добавил эффективность и скорость выполнения, что сделало объектно-ориентированное программирование доступным для реальных программистов.

05:41 Прекрасный мир объектов

• Объекты - это абстракции, созданные для симуляции событий реального мира.
• Объекты в программе являются прокси или абстракцией объектов реального мира.
• Задача программиста - построить корреляцию между объектами программы и реального мира.
• Один объект в программе может взаимодействовать с несколькими объектами реального мира.

09:13 Абстракция в объектно-ориентированном программировании

• Абстракция событий и объектов реального мира является основным инструментом ООП.
• В императивном программировании, например, в языке Паскаль, это сложно реализовать.
• Объекты позволяют создавать интуитивно понятные абстракции, что отличает их от процедур.

10:06 Динамическая диспетчеризация

• Динамическая диспетчеризация или позднее связывание позволяет абстрагироваться от конкретной реализации метода.
• Метод не знает, какой объект будет использоваться, и полагается на обещание реализации метода.
• Это снижает сложность программ, позволяя игнорировать детали.

12:02 Инкапсуляция

• Инкапсуляция скрывает информацию о типе объекта, что называется информейшн хайдинг.
• Программист не знает, что объект является яблоком или сливой, но может определить это по косвенным признакам.
• Правильное построение абстракций делает программы удобными для программирования.

13:38 Проблемы производительности ООП

• ООП может быть удобным для программиста, но медленным для компьютера.
• В языке Self все было объектом, что делало его неудобным для компьютера.
• Отправка сообщений между объектами замедляет выполнение программ.

17:09 Исследования производительности

• Исследования показали, что ООП-код работает в 20 раз медленнее, чем процедурный код.
• Пример с вычислением числа Фибоначчи показал, что ООП-код может быть в 500 раз медленнее.
• Современные оптимизации не приближают ООП к скорости процедурного программирования.

20:40 Почему объекты медленные?

• Виртуальный диспач: компьютер должен найти метод для перенаправления запроса, что занимает время.
• Локация объектов на куче: медленная память требует выделения и освобождения памяти, что замедляет работу.

22:37 Пример с массивом строк

• Эксперимент: обработка массива из 10 миллионов строк на Java 23 с использованием объектов занимает 154 мс, без объектов - 26 мс.
• Java более эффективно работает с кучей, но все равно не справляется с задачей.

24:47 Решение проблемы медленных объектов

• Google предложил компилятору превращать объекты в операторы + и -, чтобы ускорить работу.
• Однако этого не произошло, и программисты продолжают писать процедурный код с использованием объектно-ориентированного синтаксиса.

26:50 Примеры неправильного использования объектов
27:05 Проблема 1: Статические методы
• Статические методы: программисты часто используют статические методы для ускорения, теряя объектно-ориентированность.
• Пример: сохранение строки в файл через статический метод вместо инкапсуляции данных в объекте.

30:34 Проблема 2: Проблема с null, ошибка на миллиард долларов
[[Null References The Billion Dollar Mistake]]
• Null: программисты часто проверяют, является ли возвращаемое значение null, что загрязняет код и разрушает абстракции.
• Пример: получение пользователя из базы данных и проверка на null, что приводит к разрушению абстракции.

33:27 Сравнение фреймворков

• Сравнение Spring Boot Framework и Takes по частоте использования слова "null".
• В Spring Framework слово "null" используется каждые 35 строк, что приводит к частым упоминаниям в коде.
• В фреймворке Takes слово "null" используется реже, примерно каждые 2700 строк.

34:05 Проблемы с абстракцией

• Spring Framework работает, но его абстракции утрачены.
• Takes использует другой стиль программирования, что приводит к более медленной работе.
• Проблема не в программистах, а в виртуальной машине и оборудовании.

35:01 Проблема 3: Реализация наследования

• Реализация наследования - вредная практика в объектно-ориентированном программировании.
• Пример: создание "вкусного яблока" через наследование.
• Рекомендация: использовать композицию вместо наследования.

37:54 Проблема 4: Приведение типов и отражение

• Идея абстракции в том, чтобы скрыть всё, что внутри у объекта и дать возможность работать с ним только с внешним доступным интерфейсом.
• Избегать приведение типов и отражение, так как они разрушают инкапсуляцию и абстракцию.
• Инкапсуляция защищает объект от клиентов, скрывая детали.
• Программирование на основе защиты помогает избежать уязвимостей.

40:57 Проблема 5: Мутабельность и её проблемы

• Мутабельные объекты вызывают больше всего споров.
• Джошуа Блох утверждает, что имутабельные классы лучше подходят для красивого программирования.
• Мутабельность разрушает целостность абстракции объекта.

41:54 Примеры взаимодействия с объектами

• Пример с кругом: изменение радиуса и цвета разрушает целостность объекта.
• Пример с студентом: запрос на переход в другую группу экологичен и правилен.
• Мутабельность воспринимается как структура данных, а не как абстракция.

43:42 Влияние мутабельности на производительность

• Мутабельные объекты работают медленнее из-за создания временных объектов.
• Пример с изменением цвета и радиуса: создание новых объектов при каждом изменении.
• Пример сверху выполняется быстрее и элегантнее.

45:37 Критика объектно-ориентированного программирования

• Дэвид Вест считает, что современное ООП далеко от изначальных идей.
• Эдгар Дейкстра и Алан Кей критикуют ООП за его реализацию в C++ и Java.
• Линус Торвальдс и Джефф Этвуд также выражают недовольство ООП.

49:22 Антипаттерны ООП

• Синглтоны.
• дата-объекты.
• Фабричный метод.
• ORM.
• MVC и другие паттерны рассматриваются как эгоистичные методы, управляющие данными.

52:08 Заключение и вопросы

• Переход к обсуждению, как справиться с проблемами ООП.
• Вопрос о том, что делать с текущей ситуацией в ООП.

52:21 Возвращение к идеям объектно-ориентированного программирования

• Можно создать язык программирования без статических методов, атрибутов, мутабельности, наследования, null-ссылок, отражения, аннотаций и классов.
• Примеры таких языков: Self, Io, EO и другие.
• Эти языки экспериментальные и академические, но для запуска программ лучше использовать C.

53:20 Проблемы ускорения объектно-ориентированного программирования

• Нет однозначного ответа, как сделать объекты быстрыми.
• Java и Python не знают, как ускорить объекты.

53:54 Можно создать строгий язык, запрещающий ненужные техники.

54:19 Сложность Java и необходимость упрощения

• Java имеет множество инструментов, что усложняет объекты.
• Каждый объект может содержать аннотации, наследование, интерфейсы, дженерики, статические атрибуты и перегруженные методы.
• Идея: создать язык с минимальным количеством возможностей для программиста.

55:15 Инлайнинг и его влияние на скорость

• Инлайнинг объектов во время компиляции может значительно ускорить их работу.
• Java уже делает инлайнинг в некоторых случаях, но не всегда.
• Инлайнинг возможен для простых объектов, но не для сложных.

57:08 Оптимизация использования стека

• Можно оптимизировать размещение объектов на стеке вместо кучи.
• Объекты, которые не нужны на куче, могут быть размещены на стеке.
• Пока нет четкого решения, как это сделать.

57:57 Аппаратное решение проблемы

• Объекты медленные из-за архитектуры процессоров и языков программирования.
• Идея: создать новое оборудование, которое лучше поддерживает объектно-ориентированное программирование.
• Пример: оборудование для искусственного интеллекта, которое значительно ускорило вычисления.

01:00:49 Заключение и призыв к обсуждению

• Статья в журнале Nature Nanotechnology говорит о необходимости реформы аппаратной платформы.
• Автор приглашает к обсуждению и приглашает подписаться на его телеграм-канал для получения информации о текущих исследованиях.

